{"version":4,"terraform_version":"1.9.0","serial":3,"lineage":"68afcb5d-ff9b-2691-6278-dff7b94b73c6","outputs":{"api_endpoint":{"value":"https://a2oy204c58.execute-api.us-east-2.amazonaws.com","type":"string"}},"resources":[{"module":"module.function","mode":"data","type":"archive_file","name":"source_code","provider":"provider[\"registry.opentofu.org/hashicorp/archive\"]","instances":[{"schema_version":0,"attributes":{"exclude_symlink_directories":null,"excludes":null,"id":"cb1ff39d36e754d0fa06a20fc5d86ad25e820487","output_base64sha256":"VFFF3OwaJgNN6wxopti9FB/3TEav5KZ2CPPdCnYub/w=","output_base64sha512":"hWrgpsHmkloW8o2c6OtUPIQTieDNeHLyiz/P8TggKbP2E6ETDnTTy4kFQsU9QgePV2F/BuhyMcuiT6bVmCxzNg==","output_file_mode":null,"output_md5":"5cb1fd5d9fe96c1247af90cb4720660e","output_path":".terraform/modules/function/ch3/tofu/modules/lambda/lambda-sample.zip","output_sha":"cb1ff39d36e754d0fa06a20fc5d86ad25e820487","output_sha256":"545145dcec1a26034deb0c68a6d8bd141ff74c46afe4a67608f3dd0a762e6ffc","output_sha512":"856ae0a6c1e6925a16f28d9ce8eb543c841389e0cd7872f28b3fcff1382029b3f613a1130e74d3cb890542c53d42078f57617f06e87231cba24fa6d5982c7336","output_size":239,"source":[],"source_content":null,"source_content_filename":null,"source_dir":"./src","source_file":null,"type":"zip"},"sensitive_attributes":[]}]},{"module":"module.function","mode":"data","type":"aws_iam_policy_document","name":"allow_logging","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"16712114","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\"\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Resource\":\"arn:aws:logs:*:*:*\"}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:logs:*:*:*"],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.function","mode":"data","type":"aws_iam_policy_document","name":"policy","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"2690255455","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["lambda.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.function","mode":"managed","type":"aws_iam_role","name":"lambda","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::345594598663:role/lambda-sample","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-01-25T16:24:36Z","description":"","force_detach_policies":false,"id":"lambda-sample","inline_policy":[{"name":"lambda-sample-allow-logging","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:*:*:*\"}]}"}],"managed_policy_arns":[],"max_session_duration":3600,"name":"lambda-sample","name_prefix":"","path":"/","permissions_boundary":"","tags":{},"tags_all":{},"unique_id":"AROAVA5YLCUD3F55VTXYK"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.data.aws_iam_policy_document.policy"]}]},{"module":"module.function","mode":"managed","type":"aws_iam_role_policy","name":"allow_logging","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"lambda-sample:lambda-sample-allow-logging","name":"lambda-sample-allow-logging","name_prefix":"","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"logs:PutLogEvents\",\"logs:CreateLogStream\",\"logs:CreateLogGroup\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:logs:*:*:*\"}]}","role":"lambda-sample"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.data.aws_iam_policy_document.allow_logging","module.function.data.aws_iam_policy_document.policy"]}]},{"module":"module.function","mode":"managed","type":"aws_lambda_function","name":"function","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"architectures":["x86_64"],"arn":"arn:aws:lambda:us-east-2:345594598663:function:lambda-sample","code_sha256":"VFFF3OwaJgNN6wxopti9FB/3TEav5KZ2CPPdCnYub/w=","code_signing_config_arn":"","dead_letter_config":[],"description":"","environment":[{"variables":{"NODE_ENV":"production"}}],"ephemeral_storage":[{"size":512}],"file_system_config":[],"filename":".terraform/modules/function/ch3/tofu/modules/lambda/lambda-sample.zip","function_name":"lambda-sample","handler":"index.handler","id":"lambda-sample","image_config":[],"image_uri":"","invoke_arn":"arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:345594598663:function:lambda-sample/invocations","kms_key_arn":"","last_modified":"2025-01-25T16:38:16.000+0000","layers":[],"logging_config":[{"application_log_level":"","log_format":"Text","log_group":"/aws/lambda/lambda-sample","system_log_level":""}],"memory_size":128,"package_type":"Zip","publish":false,"qualified_arn":"arn:aws:lambda:us-east-2:345594598663:function:lambda-sample:$LATEST","qualified_invoke_arn":"arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-2:345594598663:function:lambda-sample:$LATEST/invocations","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"role":"arn:aws:iam::345594598663:role/lambda-sample","runtime":"nodejs20.x","s3_bucket":null,"s3_key":null,"s3_object_version":null,"signing_job_arn":"","signing_profile_version_arn":"","skip_destroy":false,"snap_start":[],"source_code_hash":"VFFF3OwaJgNN6wxopti9FB/3TEav5KZ2CPPdCnYub/w=","source_code_size":239,"tags":{},"tags_all":{},"timeout":5,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"version":"$LATEST","vpc_config":[]},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19","dependencies":["module.function.aws_iam_role.lambda","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy"]}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_api","name":"api","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_endpoint":"https://a2oy204c58.execute-api.us-east-2.amazonaws.com","api_key_selection_expression":"$request.header.x-api-key","arn":"arn:aws:apigateway:us-east-2::/apis/a2oy204c58","body":null,"cors_configuration":[],"credentials_arn":null,"description":"","disable_execute_api_endpoint":false,"execution_arn":"arn:aws:execute-api:us-east-2:345594598663:a2oy204c58","fail_on_warnings":null,"id":"a2oy204c58","name":"lambda-sample","protocol_type":"HTTP","route_key":null,"route_selection_expression":"$request.method $request.path","tags":{},"tags_all":{},"target":null,"version":""},"sensitive_attributes":[],"private":"bnVsbA=="}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_integration","name":"lambda","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_id":"a2oy204c58","connection_id":"","connection_type":"INTERNET","content_handling_strategy":"","credentials_arn":"","description":"","id":"9xoa74l","integration_method":"POST","integration_response_selection_expression":"","integration_subtype":"","integration_type":"AWS_PROXY","integration_uri":"arn:aws:lambda:us-east-2:345594598663:function:lambda-sample","passthrough_behavior":"","payload_format_version":"1.0","request_parameters":{},"request_templates":{},"response_parameters":[],"template_selection_expression":"","timeout_milliseconds":30000,"tls_config":[]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.aws_lambda_function.function","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy","module.gateway.aws_apigatewayv2_api.api"]}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_route","name":"lambda_route","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":"GET /","schema_version":0,"attributes":{"api_id":"a2oy204c58","api_key_required":false,"authorization_scopes":[],"authorization_type":"NONE","authorizer_id":"","id":"n5ndfue","model_selection_expression":"","operation_name":"","request_models":{},"request_parameter":[],"route_key":"GET /","route_response_selection_expression":"","target":"integrations/9xoa74l"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.aws_lambda_function.function","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy","module.gateway.aws_apigatewayv2_api.api","module.gateway.aws_apigatewayv2_integration.lambda"]}]},{"module":"module.gateway","mode":"managed","type":"aws_apigatewayv2_stage","name":"default","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"access_log_settings":[],"api_id":"a2oy204c58","arn":"arn:aws:apigateway:us-east-2::/apis/a2oy204c58/stages/$default","auto_deploy":true,"client_certificate_id":"","default_route_settings":[{"data_trace_enabled":false,"detailed_metrics_enabled":false,"logging_level":"","throttling_burst_limit":10000,"throttling_rate_limit":10000}],"deployment_id":"kfawh4","description":"","execution_arn":"arn:aws:execute-api:us-east-2:345594598663:a2oy204c58/$default","id":"$default","invoke_url":"https://a2oy204c58.execute-api.us-east-2.amazonaws.com/","name":"$default","route_settings":[],"stage_variables":{},"tags":{},"tags_all":{}},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.gateway.aws_apigatewayv2_api.api"]}]},{"module":"module.gateway","mode":"managed","type":"aws_lambda_permission","name":"allow_invoke","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":"GET /","schema_version":0,"attributes":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"arn:aws:lambda:us-east-2:345594598663:function:lambda-sample","function_url_auth_type":null,"id":"AllowAPIGatewayToCallSampleAppLambda","principal":"apigateway.amazonaws.com","principal_org_id":null,"qualifier":"","source_account":null,"source_arn":"arn:aws:execute-api:us-east-2:345594598663:a2oy204c58/*/GET/","statement_id":"AllowAPIGatewayToCallSampleAppLambda","statement_id_prefix":""},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.function.aws_iam_role.lambda","module.function.aws_lambda_function.function","module.function.data.archive_file.source_code","module.function.data.aws_iam_policy_document.policy","module.gateway.aws_apigatewayv2_api.api"]}]}],"check_results":null}
